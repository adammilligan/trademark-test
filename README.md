# High-Performance AI Chat Interface (тестовое)

SPA, эмулирующее чат с LLM, с упором на **производительность** при больших объёмах истории (5MB+) и **частых streaming-обновлениях** (чанки каждые 10–20мс) без блокировки UI.

## Стек

- **React + TypeScript**
- **Zustand** — состояние чата
- **Vite** — сборка
- **Tailwind CSS** — стили
- **@tanstack/react-virtual** — виртуализация списка сообщений
- **react-markdown + remark-gfm** — базовый Markdown (code blocks, bold)

## Быстрый старт (npm)

Проект ведётся через **npm** (есть `package-lock.json`).

```bash
npm install
npm run dev
```

Другие команды:

```bash
npm run build
npm run preview
npm run lint
```

## Как пользоваться

- **Отправка сообщения**: вводите текст и нажимаете **Enter** — сообщение добавляется в историю и сразу стартует потоковый ответ.
- **Перенос строки**: **Cmd+Enter** (macOS) / **Ctrl+Enter** (Windows/Linux) вставляет перенос строки в textarea.
- **Stop Generating**: мгновенно останавливает генерацию.
- **Автоскролл**:
  - если пользователь **не прокручивает вверх**, при стриминге чат держится внизу
  - если пользователь **прокрутил вверх**, автоскролл выключается и появляется кнопка **«↓ Вниз»**
  - кнопка скроллит в самый низ и снова включает автоскролл

## Технические детали (производительность)

- **Streaming без фризов**: чанки копятся в буфере и «флашатся» в Zustand через `requestAnimationFrame`, чтобы не дергать React на каждом тике таймера.
- **Виртуализация**: DOM не разрастается до 5MB+, так как рендерятся только видимые элементы списка.
- **Markdown**: рендерится только в видимой области (за счёт виртуализации); дополнительно используется `useDeferredValue` для содержимого сообщения.

Ключевые настройки стриминга лежат в `src/shared/config/chatConfig.ts`.

## Архитектура (FSD)

Структура каталога `src`:

- `app/` — приложение (точка входа/глобальные стили)
- `pages/` — страницы
- `widgets/` — крупные блоки UI
- `features/` — пользовательские сценарии (инпут, панель генерации)
- `entities/` — доменные сущности (чат/сообщения)
- `shared/` — общие утилиты/конфиги

## Кодстайл и линтер

- **Типы/интерфейсы**:
  - `type` начинается с `T` (например, `TChatState`)
  - `interface` начинается с `I`
- **Точные версии зависимостей**: `.npmrc` содержит `save-exact=true`, поэтому npm сохраняет версии **без `^`**.
- **Сортировка импортов**: настроена через `eslint-plugin-perfectionist` (группы под FSD-алиасы `@shared`, `@entities`, `@features`, `@widgets`, `@pages`, `@app`).

## Что можно улучшить (если расширять)

- Вынести тяжёлый Markdown-парсинг в Web Worker для экстремальных лонгридов.
- Добавить «умный» рендер: парсить Markdown только для видимой части, а остальное отображать как plain-text до попадания в viewport.
